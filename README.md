# PanSou ç½‘ç›˜æœç´¢API

PanSouæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ç½‘ç›˜èµ„æºæœç´¢APIæœåŠ¡ï¼Œæ”¯æŒTGæœç´¢å’Œè‡ªå®šä¹‰æ’ä»¶æœç´¢ã€‚ç³»ç»Ÿè®¾è®¡ä»¥æ€§èƒ½å’Œå¯æ‰©å±•æ€§ä¸ºæ ¸å¿ƒï¼Œæ”¯æŒå¹¶å‘æœç´¢ã€ç»“æœæ™ºèƒ½æ’åºå’Œç½‘ç›˜ç±»å‹åˆ†ç±»ã€‚

[//]: # (MCPæœåŠ¡æ–‡æ¡£: [MCP-SERVICE.md]&#40;docs/MCP-SERVICE.md&#41;)


## ç‰¹æ€§ï¼ˆ[è¯¦è§ç³»ç»Ÿè®¾è®¡æ–‡æ¡£](docs/%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3.md)ï¼‰

- **é«˜æ€§èƒ½æœç´¢**ï¼šå¹¶å‘æ‰§è¡Œå¤šä¸ªTGé¢‘é“åŠå¼‚æ­¥æ’ä»¶æœç´¢ï¼Œæ˜¾è‘—æå‡æœç´¢é€Ÿåº¦ï¼›å·¥ä½œæ± è®¾è®¡ï¼Œé«˜æ•ˆç®¡ç†å¹¶å‘ä»»åŠ¡
- **ç½‘ç›˜ç±»å‹åˆ†ç±»**ï¼šè‡ªåŠ¨è¯†åˆ«å¤šç§ç½‘ç›˜é“¾æ¥ï¼ŒæŒ‰ç±»å‹å½’ç±»å±•ç¤º
- **æ™ºèƒ½æ’åº**ï¼šåŸºäºæ’ä»¶ç­‰çº§ã€æ—¶é—´æ–°é²œåº¦å’Œä¼˜å…ˆå…³é”®è¯çš„å¤šç»´åº¦ç»¼åˆæ’åºç®—æ³•
- **å¼‚æ­¥æ’ä»¶ç³»ç»Ÿ**ï¼šæ”¯æŒé€šè¿‡æ’ä»¶æ‰©å±•æœç´¢æ¥æºï¼Œæ”¯æŒ"å°½å¿«å“åº”ï¼ŒæŒç»­å¤„ç†"çš„å¼‚æ­¥æœç´¢æ¨¡å¼ï¼Œè§£å†³äº†æŸäº›æœç´¢æºå“åº”æ—¶é—´é•¿çš„é—®é¢˜ã€‚è¯¦æƒ…å‚è€ƒ[**æ’ä»¶å¼€å‘æŒ‡å—**](docs/æ’ä»¶å¼€å‘æŒ‡å—.md)
- **äºŒçº§ç¼“å­˜**ï¼šåˆ†ç‰‡å†…å­˜+åˆ†ç‰‡ç£ç›˜ç¼“å­˜æœºåˆ¶ï¼Œå¤§å¹…æå‡é‡å¤æŸ¥è¯¢é€Ÿåº¦å’Œå¹¶å‘æ€§èƒ½  

## MCP æœåŠ¡

PanSou è¿˜æä¾›äº†ä¸€ä¸ªåŸºäº [Model Context Protocol (MCP)](https://modelcontextprotocol.io) çš„æœåŠ¡ï¼Œå¯ä»¥å°†æœç´¢åŠŸèƒ½é›†æˆåˆ° Claude Desktop ç­‰æ”¯æŒ MCP çš„åº”ç”¨ä¸­ã€‚è¯¦æƒ…è¯·å‚é˜… [MCP æœåŠ¡æ–‡æ¡£](docs/MCP-SERVICE.md)ã€‚

## æ”¯æŒçš„ç½‘ç›˜ç±»å‹

ç™¾åº¦ç½‘ç›˜ (`baidu`)ã€é˜¿é‡Œäº‘ç›˜ (`aliyun`)ã€å¤¸å…‹ç½‘ç›˜ (`quark`)ã€å¤©ç¿¼äº‘ç›˜ (`tianyi`)ã€UCç½‘ç›˜ (`uc`)ã€ç§»åŠ¨äº‘ç›˜ (`mobile`)ã€115ç½‘ç›˜ (`115`)ã€PikPak (`pikpak`)ã€è¿…é›·ç½‘ç›˜ (`xunlei`)ã€123ç½‘ç›˜ (`123`)ã€ç£åŠ›é“¾æ¥ (`magnet`)ã€ç”µé©´é“¾æ¥ (`ed2k`)ã€å…¶ä»– (`others`)

## å¿«é€Ÿå¼€å§‹

åœ¨ Github ä¸Šå…ˆ[![Fork me on GitHub](https://raw.githubusercontent.com/fishforks/fish2018/refs/heads/main/forkme.png)](https://github.com/fish2018/pansou/fork)
æœ¬é¡¹ç›®ï¼Œå¹¶ç‚¹ä¸Š Star !!!

### ä½¿ç”¨Dockeréƒ¨ç½²
[å¸¸è§é—®é¢˜æ€»ç»“](https://github.com/fish2018/pansou/issues/46)  

[TGèµ„æºé¢‘é“åˆ—è¡¨](https://github.com/fish2018/pansou/issues/4)

[gyingæ’ä»¶æ–‡æ¡£](https://github.com/fish2018/pansou/blob/main/plugin/gying/README.md)

<details>
<summary>æ’ä»¶åˆ—è¡¨ï¼ˆè¯·åŠ¡å¿…æŒ‰éœ€åŠ è½½ï¼‰</summary>
<pre>
export ENABLED_PLUGINS=hunhepan,jikepan,panwiki,pansearch,panta,qupansou,
susu,thepiratebay,wanou,xuexizhinan,panyq,zhizhen,labi,muou,ouge,shandian,
duoduo,huban,cyg,erxiao,miaoso,fox4k,pianku,clmao,wuji,cldi,xiaozhang,
libvio,leijing,xb6v,xys,ddys,hdmoli,yuhuage,u3c3,javdb,clxiong,jutoushe,
sdso,xiaoji,xdyh,haisou,bixin,djgou,nyaa,xinjuc,aikanzy,qupanshe,xdpan,
discourse,yunsou,ahhhhfs,nsgame,gying,quark4k,quarksoo,sousou,ash
</pre>
</details>

#### **1ã€å‰åç«¯é›†æˆç‰ˆ**

##### ç›´æ¥ä½¿ç”¨Dockerå‘½ä»¤

ä¸€é”®å¯åŠ¨ï¼Œå¼€ç®±å³ç”¨

```
docker run -d --name pansou -p 80:80 -e ENABLED_PLUGINS="labi,zhizhen,shandian,duoduo,muou,wanou" ghcr.io/fish2018/pansou-web
```

##### ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰
```
# ä¸‹è½½é…ç½®æ–‡ä»¶
curl -o docker-compose.yml https://raw.githubusercontent.com/fish2018/pansou-web/refs/heads/main/docker-compose.yml

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

#### **2ã€çº¯åç«¯APIç‰ˆ**

##### ç›´æ¥ä½¿ç”¨Dockerå‘½ä»¤

```bash
docker run -d --name pansou -p 8888:8888 -v pansou-cache:/app/cache -e CHANNELS="tgsearchers3,xxx" -e ENABLED_PLUGINS="labi,zhizhen,shandian,duoduo,muou,wanou" ghcr.io/fish2018/pansou:latest
```

##### ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰

```bash
# ä¸‹è½½é…ç½®æ–‡ä»¶
curl -o docker-compose.yml  https://raw.githubusercontent.com/fish2018/pansou/refs/heads/main/docker-compose.yml

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# è®¿é—®æœåŠ¡
http://localhost:8888
```

### ä»æºç å®‰è£…

#### ç¯å¢ƒè¦æ±‚

- Go 1.18+
- å¯é€‰ï¼šSOCKS5ä»£ç†ï¼ˆç”¨äºè®¿é—®å—é™åœ°åŒºçš„Telegramç«™ç‚¹ï¼‰

1. å…‹éš†ä»“åº“

```bash
git clone https://github.com/fish2018/pansou.git
cd pansou
```

2. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

#### åŸºç¡€é…ç½®

| ç¯å¢ƒå˜é‡ | æè¿° | é»˜è®¤å€¼ | è¯´æ˜ |
|----------|------|--------|------|
| **PORT** | æœåŠ¡ç«¯å£ | `8888` | ä¿®æ”¹æœåŠ¡ç›‘å¬ç«¯å£ |
| **PROXY** | SOCKS5ä»£ç† | æ—  | å¦‚ï¼š`socks5://127.0.0.1:1080` |
| **CHANNELS** | é»˜è®¤æœç´¢çš„TGé¢‘é“ | `tgsearchers3` | å¤šä¸ªé¢‘é“ç”¨é€—å·åˆ†éš” |
| **ENABLED_PLUGINS** | æŒ‡å®šå¯ç”¨æ’ä»¶ï¼Œå¤šä¸ªæ’ä»¶ç”¨é€—å·åˆ†éš” | æ—  | å¿…é¡»æ˜¾å¼æŒ‡å®š |

#### è®¤è¯é…ç½®ï¼ˆå¯é€‰ï¼‰

PanSouæ”¯æŒå¯é€‰çš„å®‰å…¨è®¤è¯åŠŸèƒ½ï¼Œé»˜è®¤å…³é—­ã€‚å¼€å¯åï¼Œæ‰€æœ‰APIæ¥å£ï¼ˆé™¤ç™»å½•æ¥å£å¤–ï¼‰éƒ½éœ€è¦æä¾›æœ‰æ•ˆçš„JWT Tokenã€‚è¯¦è§[è®¤è¯ç³»ç»Ÿè®¾è®¡æ–‡æ¡£](docs/è®¤è¯ç³»ç»Ÿè®¾è®¡.md)ã€‚

| ç¯å¢ƒå˜é‡ | æè¿° | é»˜è®¤å€¼ | è¯´æ˜ |
|----------|------|--------|------|
| **AUTH_ENABLED** | æ˜¯å¦å¯ç”¨è®¤è¯ | `false` | è®¾ç½®ä¸º`true`å¯ç”¨è®¤è¯åŠŸèƒ½ |
| **AUTH_USERS** | ç”¨æˆ·è´¦å·é…ç½® | æ—  | æ ¼å¼ï¼š`user1:pass1,user2:pass2` |
| **AUTH_TOKEN_EXPIRY** | Tokenæœ‰æ•ˆæœŸï¼ˆå°æ—¶ï¼‰ | `24` | JWT Tokençš„æœ‰æ•ˆæ—¶é•¿ |
| **AUTH_JWT_SECRET** | JWTç­¾åå¯†é’¥ | è‡ªåŠ¨ç”Ÿæˆ | ç”¨äºç­¾åTokenï¼Œå»ºè®®æ‰‹åŠ¨è®¾ç½® |

**è®¤è¯é…ç½®ç¤ºä¾‹ï¼š**

```bash
# å¯ç”¨è®¤è¯å¹¶é…ç½®å•ä¸ªç”¨æˆ·
docker run -d --name pansou -p 8888:8888 \
  -e AUTH_ENABLED=true \
  -e AUTH_USERS=admin:admin123 \
  -e AUTH_TOKEN_EXPIRY=24 \
  ghcr.io/fish2018/pansou:latest

# é…ç½®å¤šä¸ªç”¨æˆ·
docker run -d --name pansou -p 8888:8888 \
  -e AUTH_ENABLED=true \
  -e AUTH_USERS=admin:pass123,user1:pass456,user2:pass789 \
  ghcr.io/fish2018/pansou:latest
```

**è®¤è¯APIæ¥å£ï¼š**

- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•ï¼Œè·å–Token
- `POST /api/auth/verify` - éªŒè¯Tokenæœ‰æ•ˆæ€§
- `POST /api/auth/logout` - é€€å‡ºç™»å½•ï¼ˆå®¢æˆ·ç«¯åˆ é™¤Tokenï¼‰

**ä½¿ç”¨Tokenè°ƒç”¨APIï¼š**

```bash
# 1. ç™»å½•è·å–Token
curl -X POST http://localhost:8888/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'

# å“åº”ï¼š{"token":"eyJhbGc...","expires_at":1234567890,"username":"admin"}

# 2. ä½¿ç”¨Tokenè°ƒç”¨æœç´¢API
curl -X POST http://localhost:8888/api/search \
  -H "Authorization: Bearer eyJhbGc..." \
  -H "Content-Type: application/json" \
  -d '{"kw":"é€Ÿåº¦ä¸æ¿€æƒ…"}'
```

#### é«˜çº§é…ç½®ï¼ˆé»˜è®¤å€¼å³å¯ï¼‰

<details>
<summary>ç‚¹å‡»å±•å¼€é«˜çº§é…ç½®é€‰é¡¹ï¼ˆé€šå¸¸ä¸éœ€è¦ä¿®æ”¹ï¼‰</summary>

| ç¯å¢ƒå˜é‡ | æè¿° | é»˜è®¤å€¼ |
|----------|------|--------|
| CONCURRENCY | å¹¶å‘æœç´¢æ•° | è‡ªåŠ¨è®¡ç®— |
| CACHE_TTL | ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆåˆ†é’Ÿï¼‰ | `60` |
| CACHE_MAX_SIZE | æœ€å¤§ç¼“å­˜å¤§å°(MB) | `100` |
| PLUGIN_TIMEOUT | æ’ä»¶è¶…æ—¶æ—¶é—´(ç§’) | `30` |
| ASYNC_RESPONSE_TIMEOUT | å¿«é€Ÿå“åº”è¶…æ—¶(ç§’) | `4` |
| ASYNC_LOG_ENABLED | å¼‚æ­¥æ’ä»¶è¯¦ç»†æ—¥å¿— | `true` | 
| CACHE_PATH | ç¼“å­˜æ–‡ä»¶è·¯å¾„ | `./cache` |
| SHARD_COUNT | ç¼“å­˜åˆ†ç‰‡æ•°é‡ | `8` |
| CACHE_WRITE_STRATEGY | ç¼“å­˜å†™å…¥ç­–ç•¥(immediate/hybrid) | `hybrid` |
| ENABLE_COMPRESSION | æ˜¯å¦å¯ç”¨å‹ç¼© | `false` |
| MIN_SIZE_TO_COMPRESS | æœ€å°å‹ç¼©é˜ˆå€¼(å­—èŠ‚) | `1024` |
| GC_PERCENT | Go GCè§¦å‘ç™¾åˆ†æ¯” | `50` |
| ASYNC_MAX_BACKGROUND_WORKERS | æœ€å¤§åå°å·¥ä½œè€…æ•°é‡ | CPUæ ¸å¿ƒæ•°Ã—5 |
| ASYNC_MAX_BACKGROUND_TASKS | æœ€å¤§åå°ä»»åŠ¡æ•°é‡ | å·¥ä½œè€…æ•°Ã—5 |
| ASYNC_CACHE_TTL_HOURS | å¼‚æ­¥ç¼“å­˜æœ‰æ•ˆæœŸ(å°æ—¶) | `1` |
| ASYNC_PLUGIN_ENABLED | å¼‚æ­¥æ’ä»¶æ˜¯å¦å¯ç”¨ | `true` |
| HTTP_READ_TIMEOUT | HTTPè¯»å–è¶…æ—¶(ç§’) | è‡ªåŠ¨è®¡ç®— |
| HTTP_WRITE_TIMEOUT | HTTPå†™å…¥è¶…æ—¶(ç§’) | è‡ªåŠ¨è®¡ç®— |
| HTTP_IDLE_TIMEOUT | HTTPç©ºé—²è¶…æ—¶(ç§’) | `120` |
| HTTP_MAX_CONNS | HTTPæœ€å¤§è¿æ¥æ•° | è‡ªåŠ¨è®¡ç®— |

</details>

3. æ„å»º

```linux
CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags="-s -w -extldflags '-static'" -o pansou .
```

4. è¿è¡Œ

```bash
./pansou
```

### å…¶ä»–é…ç½®å‚è€ƒ

<details>
<summary>ç‚¹å‡»å±•å¼€ supervisor é…ç½®å‚è€ƒ</summary>

```
[program:pansou]
environment=PORT=8888,CHANNELS="tgsearchers3,Aliyun_4K_Movies,bdbdndn11,yunpanx,bsbdbfjfjff,yp123pan,sbsbsnsqq,yunpanxunlei,tianyifc,BaiduCloudDisk,txtyzy,peccxinpd,gotopan,PanjClub,kkxlzy,baicaoZY,MCPH01,bdwpzhpd,ysxb48,jdjdn1111,yggpan,MCPH086,zaihuayun,Q66Share,Oscar_4Kmovies,ucwpzy,shareAliyun,alyp_1,dianyingshare,Quark_Movies,XiangxiuNBB,ydypzyfx,ucquark,xx123pan,yingshifenxiang123,zyfb123,tyypzhpd,tianyirigeng,cloudtianyi,hdhhd21,Lsp115,oneonefivewpfx,qixingzhenren,taoxgzy,Channel_Shares_115,tyysypzypd,vip115hot,wp123zy,yunpan139,yunpan189,yunpanuc,yydf_hzl,leoziyuan,pikpakpan,Q_dongman,yoyokuakeduanju",ENABLED_PLUGINS="labi,zhizhen,shandian,duoduo,muou"
command=/home/work/pansou/pansou
directory=/home/work/pansou
autostart=true
autorestart=true
startsecs=5
startretries=3
exitcodes=0
stopwaitsecs=10
stopasgroup=true
killasgroup=true
```

</details>

<details>
<summary>ç‚¹å‡»å±•å¼€ nginx é…ç½®å‚è€ƒ</summary>

```
server {
    listen 80;
    server_name pansou.252035.xyz;

    # å°† HTTP é‡å®šå‘åˆ° HTTPS
    return 301 https://$host$request_uri;
}

limit_req_zone $binary_remote_addr zone=api_limit:10m rate=60r/m;

server {
    listen 443 ssl http2;
    server_name pansou.252035.xyz;

    access_log /home/work/logs/pansou.log;

    # è¯ä¹¦å’Œå¯†é’¥è·¯å¾„
    ssl_certificate /etc/letsencrypt/live/252035.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/252035.xyz/privkey.pem;

    # å¢å¼º SSL å®‰å…¨æ€§
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH;
    ssl_prefer_server_ciphers on;

    # åç«¯ä»£ç†ï¼Œåº”ç”¨é™æµ
    location / {
        # åº”ç”¨é™æµè§„åˆ™
        limit_req zone=api_limit burst=10 nodelay;
        # å½“è¶…è¿‡é™åˆ¶æ—¶è¿”å› 429 çŠ¶æ€ç 
        limit_req_status 429;

        proxy_pass http://127.0.0.1:8888;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

</details>

## APIæ–‡æ¡£

### è®¤è¯è¯´æ˜

å½“å¯ç”¨è®¤è¯åŠŸèƒ½ï¼ˆ`AUTH_ENABLED=true`ï¼‰æ—¶ï¼Œé™¤ç™»å½•å’Œå¥åº·æ£€æµ‹æ¥å£å¤–çš„æ‰€æœ‰APIæ¥å£éƒ½éœ€è¦æä¾›æœ‰æ•ˆçš„JWT Tokenã€‚

**è¯·æ±‚å¤´æ ¼å¼**ï¼š
```
Authorization: Bearer <your-jwt-token>
```

**è·å–Token**ï¼š

1. è°ƒç”¨ç™»å½•æ¥å£è·å–Tokenï¼ˆè¯¦è§ä¸‹æ–¹[è®¤è¯API](#è®¤è¯API)ï¼‰
2. åœ¨åç»­æ‰€æœ‰APIè¯·æ±‚çš„Headerä¸­æ·»åŠ `Authorization: Bearer <token>`
3. Tokenè¿‡æœŸåéœ€è¦é‡æ–°ç™»å½•è·å–æ–°Token

**ç¤ºä¾‹**ï¼š
```bash
# æœªå¯ç”¨è®¤è¯æ—¶
curl -X POST http://localhost:8888/api/search \
  -H "Content-Type: application/json" \
  -d '{"kw":"é€Ÿåº¦ä¸æ¿€æƒ…"}'

# å¯ç”¨è®¤è¯æ—¶
curl -X POST http://localhost:8888/api/search \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eyJhbGc..." \
  -d '{"kw":"é€Ÿåº¦ä¸æ¿€æƒ…"}'
```

### è®¤è¯API

#### ç”¨æˆ·ç™»å½•

è·å–JWT Tokenç”¨äºåç»­APIè°ƒç”¨ã€‚

**æ¥å£åœ°å€**ï¼š`/api/auth/login`  
**è¯·æ±‚æ–¹æ³•**ï¼š`POST`  
**Content-Type**ï¼š`application/json`  
**æ˜¯å¦éœ€è¦è®¤è¯**ï¼šå¦

**è¯·æ±‚å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| username | string | æ˜¯ | ç”¨æˆ·å |
| password | string | æ˜¯ | å¯†ç  |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```bash
curl -X POST http://localhost:8888/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

**æˆåŠŸå“åº”**ï¼š
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expires_at": 1234567890,
  "username": "admin"
}
```

**é”™è¯¯å“åº”**ï¼š
```json
{
  "error": "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"
}
```

#### éªŒè¯Token

éªŒè¯å½“å‰Tokenæ˜¯å¦æœ‰æ•ˆã€‚

**æ¥å£åœ°å€**ï¼š`/api/auth/verify`  
**è¯·æ±‚æ–¹æ³•**ï¼š`POST`  
**æ˜¯å¦éœ€è¦è®¤è¯**ï¼šæ˜¯

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```bash
curl -X POST http://localhost:8888/api/auth/verify \
  -H "Authorization: Bearer eyJhbGc..."
```

**æˆåŠŸå“åº”**ï¼š
```json
{
  "valid": true,
  "username": "admin"
}
```

#### é€€å‡ºç™»å½•

é€€å‡ºå½“å‰ç™»å½•ï¼ˆå®¢æˆ·ç«¯åˆ é™¤Tokenå³å¯ï¼‰ã€‚

**æ¥å£åœ°å€**ï¼š`/api/auth/logout`  
**è¯·æ±‚æ–¹æ³•**ï¼š`POST`  
**æ˜¯å¦éœ€è¦è®¤è¯**ï¼šå¦

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```bash
curl -X POST http://localhost:8888/api/auth/logout
```

**æˆåŠŸå“åº”**ï¼š
```json
{
  "message": "é€€å‡ºæˆåŠŸ"
}
```

### æœç´¢API

æœç´¢ç½‘ç›˜èµ„æºã€‚

**æ¥å£åœ°å€**ï¼š`/api/search`  
**è¯·æ±‚æ–¹æ³•**ï¼š`POST` æˆ– `GET`  
**Content-Type**ï¼š`application/json`ï¼ˆPOSTæ–¹æ³•ï¼‰  
**æ˜¯å¦éœ€è¦è®¤è¯**ï¼šå–å†³äº`AUTH_ENABLED`é…ç½®

**POSTè¯·æ±‚å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| kw | string | æ˜¯ | æœç´¢å…³é”®è¯ |
| channels | string[] | å¦ | æœç´¢çš„é¢‘é“åˆ—è¡¨ï¼Œä¸æä¾›åˆ™ä½¿ç”¨é»˜è®¤é…ç½® |
| conc | number | å¦ | å¹¶å‘æœç´¢æ•°é‡ï¼Œä¸æä¾›åˆ™è‡ªåŠ¨è®¾ç½®ä¸ºé¢‘é“æ•°+æ’ä»¶æ•°+10 |
| refresh | boolean | å¦ | å¼ºåˆ¶åˆ·æ–°ï¼Œä¸ä½¿ç”¨ç¼“å­˜ï¼Œä¾¿äºè°ƒè¯•å’Œè·å–æœ€æ–°æ•°æ® |
| res | string | å¦ | ç»“æœç±»å‹ï¼šall(è¿”å›æ‰€æœ‰ç»“æœ)ã€results(ä»…è¿”å›results)ã€merge(ä»…è¿”å›merged_by_type)ï¼Œé»˜è®¤ä¸ºmerge |
| src | string | å¦ | æ•°æ®æ¥æºç±»å‹ï¼šall(é»˜è®¤ï¼Œå…¨éƒ¨æ¥æº)ã€tg(ä»…Telegram)ã€plugin(ä»…æ’ä»¶) |
| plugins | string[] | å¦ | æŒ‡å®šæœç´¢çš„æ’ä»¶åˆ—è¡¨ï¼Œä¸æŒ‡å®šåˆ™æœç´¢å…¨éƒ¨æ’ä»¶ |
| cloud_types | string[] | å¦ | æŒ‡å®šè¿”å›çš„ç½‘ç›˜ç±»å‹åˆ—è¡¨ï¼Œæ”¯æŒï¼šbaiduã€aliyunã€quarkã€tianyiã€ucã€mobileã€115ã€pikpakã€xunleiã€123ã€magnetã€ed2kï¼Œä¸æŒ‡å®šåˆ™è¿”å›æ‰€æœ‰ç±»å‹ |
| ext | object | å¦ | æ‰©å±•å‚æ•°ï¼Œç”¨äºä¼ é€’ç»™æ’ä»¶çš„è‡ªå®šä¹‰å‚æ•°ï¼Œå¦‚{"title_en":"English Title", "is_all":true} |

**GETè¯·æ±‚å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| kw | string | æ˜¯ | æœç´¢å…³é”®è¯ |
| channels | string | å¦ | æœç´¢çš„é¢‘é“åˆ—è¡¨ï¼Œä½¿ç”¨è‹±æ–‡é€—å·åˆ†éš”å¤šä¸ªé¢‘é“ï¼Œä¸æä¾›åˆ™ä½¿ç”¨é»˜è®¤é…ç½® |
| conc | number | å¦ | å¹¶å‘æœç´¢æ•°é‡ï¼Œä¸æä¾›åˆ™è‡ªåŠ¨è®¾ç½®ä¸ºé¢‘é“æ•°+æ’ä»¶æ•°+10 |
| refresh | boolean | å¦ | å¼ºåˆ¶åˆ·æ–°ï¼Œè®¾ç½®ä¸º"true"è¡¨ç¤ºä¸ä½¿ç”¨ç¼“å­˜ |
| res | string | å¦ | ç»“æœç±»å‹ï¼šall(è¿”å›æ‰€æœ‰ç»“æœ)ã€results(ä»…è¿”å›results)ã€merge(ä»…è¿”å›merged_by_type)ï¼Œé»˜è®¤ä¸ºmerge |
| src | string | å¦ | æ•°æ®æ¥æºç±»å‹ï¼šall(é»˜è®¤ï¼Œå…¨éƒ¨æ¥æº)ã€tg(ä»…Telegram)ã€plugin(ä»…æ’ä»¶) |
| plugins | string | å¦ | æŒ‡å®šæœç´¢çš„æ’ä»¶åˆ—è¡¨ï¼Œä½¿ç”¨è‹±æ–‡é€—å·åˆ†éš”å¤šä¸ªæ’ä»¶åï¼Œä¸æŒ‡å®šåˆ™æœç´¢å…¨éƒ¨æ’ä»¶ |
| cloud_types | string | å¦ | æŒ‡å®šè¿”å›çš„ç½‘ç›˜ç±»å‹åˆ—è¡¨ï¼Œä½¿ç”¨è‹±æ–‡é€—å·åˆ†éš”å¤šä¸ªç±»å‹ï¼Œæ”¯æŒï¼šbaiduã€aliyunã€quarkã€tianyiã€ucã€mobileã€115ã€pikpakã€xunleiã€123ã€magnetã€ed2kï¼Œä¸æŒ‡å®šåˆ™è¿”å›æ‰€æœ‰ç±»å‹ |
| ext | string | å¦ | JSONæ ¼å¼çš„æ‰©å±•å‚æ•°ï¼Œç”¨äºä¼ é€’ç»™æ’ä»¶çš„è‡ªå®šä¹‰å‚æ•°ï¼Œå¦‚{"title_en":"English Title", "is_all":true} |

**POSTè¯·æ±‚ç¤ºä¾‹**ï¼š

```bash
# æœªå¯ç”¨è®¤è¯
curl -X POST http://localhost:8888/api/search \
  -H "Content-Type: application/json" \
  -d '{
    "kw": "é€Ÿåº¦ä¸æ¿€æƒ…",
    "channels": ["tgsearchers3", "xxx"],
    "conc": 2,
    "refresh": true,
    "res": "merge",
    "src": "all",
    "plugins": ["jikepan"],
    "cloud_types": ["baidu", "quark"],
    "ext": {
      "title_en": "Fast and Furious",
      "is_all": true
    }
  }'

# å¯ç”¨è®¤è¯æ—¶ï¼ˆéœ€è¦æ·»åŠ Authorizationå¤´ï¼‰
curl -X POST http://localhost:8888/api/search \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
  -d '{
    "kw": "é€Ÿåº¦ä¸æ¿€æƒ…",
    "res": "merge"
  }'
```

**GETè¯·æ±‚ç¤ºä¾‹**ï¼š

```bash
# æœªå¯ç”¨è®¤è¯
curl "http://localhost:8888/api/search?kw=é€Ÿåº¦ä¸æ¿€æƒ…&res=merge&src=tg"

# å¯ç”¨è®¤è¯æ—¶ï¼ˆéœ€è¦æ·»åŠ Authorizationå¤´ï¼‰
curl "http://localhost:8888/api/search?kw=é€Ÿåº¦ä¸æ¿€æƒ…&res=merge" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

**æˆåŠŸå“åº”**ï¼š

```json
{
  "total": 15,
  "results": [
    {
      "message_id": "12345",
      "unique_id": "channel-12345",
      "channel": "tgsearchers3",
      "datetime": "2023-06-10T14:23:45Z",
      "title": "é€Ÿåº¦ä¸æ¿€æƒ…å…¨é›†1-10",
      "content": "é€Ÿåº¦ä¸æ¿€æƒ…ç³»åˆ—å…¨é›†ï¼Œ1080Pé«˜æ¸…...",
      "links": [
        {
          "type": "baidu",
          "url": "https://pan.baidu.com/s/1abcdef",
          "password": "1234"
        }
      ],
      "tags": ["ç”µå½±", "åˆé›†"],
      "images": [
        "https://cdn1.cdn-telegram.org/file/xxx.jpg"
      ]
    },
    // æ›´å¤šç»“æœ...
  ],
  "merged_by_type": {
    "baidu": [
      {
        "url": "https://pan.baidu.com/s/1abcdef",
        "password": "1234",
        "note": "é€Ÿåº¦ä¸æ¿€æƒ…å…¨é›†1-10",
        "datetime": "2023-06-10T14:23:45Z",
        "source": "tg:é¢‘é“åç§°",
        "images": [
          "https://cdn1.cdn-telegram.org/file/xxx.jpg"
        ]
      },
      // æ›´å¤šç™¾åº¦ç½‘ç›˜é“¾æ¥...
    ],
    "quark": [
      {
        "url": "https://pan.quark.cn/s/xxxx",
        "password": "",
        "note": "å‡¡äººä¿®ä»™ä¼ ",
        "datetime": "2023-06-10T15:30:22Z",
        "source": "plugin:æ’ä»¶å",
        "images": []
      }
    ],
    "aliyun": [
      // é˜¿é‡Œäº‘ç›˜é“¾æ¥...
    ]
    // æ›´å¤šç½‘ç›˜ç±»å‹...
  }
}
```

**å­—æ®µè¯´æ˜**ï¼š

- `source`: æ•°æ®æ¥æºæ ‡è¯†
  - `tg:é¢‘é“åç§°`: æ¥è‡ªTelegramé¢‘é“
  - `plugin:æ’ä»¶å`: æ¥è‡ªæŒ‡å®šæ’ä»¶
  - `unknown`: æœªçŸ¥æ¥æº
- `images`: TGæ¶ˆæ¯ä¸­çš„å›¾ç‰‡é“¾æ¥æ•°ç»„ï¼ˆå¯é€‰å­—æ®µï¼‰
  - ä»…åœ¨æ¥æºä¸ºTelegramé¢‘é“ä¸”æ¶ˆæ¯åŒ…å«å›¾ç‰‡æ—¶å‡ºç°


**é”™è¯¯å“åº”**ï¼š

```json
// å‚æ•°é”™è¯¯
{
  "code": 400,
  "message": "å…³é”®è¯ä¸èƒ½ä¸ºç©º"
}

// æœªæˆæƒï¼ˆå¯ç”¨è®¤è¯ä½†æœªæä¾›Tokenï¼‰
{
  "error": "æœªæˆæƒï¼šç¼ºå°‘è®¤è¯ä»¤ç‰Œ",
  "code": "AUTH_TOKEN_MISSING"
}

// Tokenæ— æ•ˆæˆ–è¿‡æœŸ
{
  "error": "æœªæˆæƒï¼šä»¤ç‰Œæ— æ•ˆæˆ–å·²è¿‡æœŸ",
  "code": "AUTH_TOKEN_INVALID"
}
```

### å¥åº·æ£€æŸ¥

æ£€æŸ¥APIæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚

**æ¥å£åœ°å€**ï¼š`/api/health`  
**è¯·æ±‚æ–¹æ³•**ï¼š`GET`  
**æ˜¯å¦éœ€è¦è®¤è¯**ï¼šå¦ï¼ˆå…¬å¼€æ¥å£ï¼‰

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```bash
curl http://localhost:8888/api/health
```

**æˆåŠŸå“åº”**ï¼š

```json
{
  "status": "ok",
  "auth_enabled": true,
  "plugins_enabled": true,
  "plugin_count": 16,
  "plugins": [
    "pansearch",
    "panta", 
    "qupansou",
    "hunhepan",
    "jikepan",
    "pan666",
    "panyq",
    "susu",
    "xuexizhinan",
    "hdr4k",
    "labi",
    "shandian",
    "duoduo",
    "muou",
    "wanou",
    "ouge",
    "zhizhen",
    "huban"
  ],
  "channels_count": 1,
  "channels": [
    "tgsearchers3"
  ]
}
```

**å­—æ®µè¯´æ˜**ï¼š
- `status`: æœåŠ¡çŠ¶æ€ï¼Œ"ok"è¡¨ç¤ºæ­£å¸¸
- `auth_enabled`: æ˜¯å¦å¯ç”¨è®¤è¯åŠŸèƒ½
- `plugins_enabled`: æ˜¯å¦å¯ç”¨æ’ä»¶
- `plugin_count`: å·²å¯ç”¨çš„æ’ä»¶æ•°é‡
- `plugins`: å·²å¯ç”¨çš„æ’ä»¶åˆ—è¡¨
- `channels_count`: é…ç½®çš„é¢‘é“æ•°é‡
- `channels`: é…ç½®çš„é¢‘é“åˆ—è¡¨

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦æƒ…è¯·è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## â­ Star å†å²

[![Star History Chart](https://api.star-history.com/svg?repos=fish2018/pansou&type=Date)](https://star-history.com/#fish2018/pansou&Date)
